(this["webpackJsonpwebsite-project"]=this["webpackJsonpwebsite-project"]||[]).push([[0],{118:function(e,t,n){},119:function(e,t,n){},221:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(14),s=n.n(i),c=(n(118),n(33)),o=(n(119),n(18)),u=n(20),l=n(101),d=n(100),h=n(93),v=n(7);function f(e){for(var t=[],n=0,a=0;a<e.length;a++)n+=e[a],t[a]=n;return t}var g=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(v.jsx)(h.Line,{data:(e=this.props.data,t=this.props.dates,{labels:t,datasets:[{label:"Total distance (km)",data:f(e),fill:!0,lineTension:0,backgroundColor:"rgba(75,192,192,0.2)",borderColor:"rgba(75,192,192,1)"}]}),options:{maintainAspectRatio:!1}});var e,t}}]),n}(a.Component),j=function(){function e(){Object(o.a)(this,e),this.entries=[],this.it=0}return Object(u.a)(e,[{key:"addDataEntry",value:function(e,t){this.entries.push(new b(e,t))}},{key:"getEarliestDate",value:function(){for(var e=new Date,t=Number(e),n=0;n<this.entries.length;n++){var a=Number(new Date(this.entries[n].date));a<t&&(t=a,e=this.entries[n].date)}return new Date(e)}},{key:"getLatestDate",value:function(){for(var e=new Date,t=Number(e),n=0;n<this.entries.length;n++){var a=Number(new Date(this.entries[n].date));a>t&&(t=a,e=this.entries[n].date)}return new Date(e)}},{key:"getDates",value:function(){for(var e=[],t=this.getEarliestDate(),n=this.getLatestDate(),a=this.getDaysUntil(t,n)+3,r=0;r<a;r++){var i=new Date(t);i.setDate(i.getDate()+r-1);var s=i.toISOString().substring(0,10);e.push(s)}return e}},{key:"getAdditionOnDate",value:function(e){for(var t=0,n=0;n<this.entries.length;n++)this.entries[n].date===e&&(t+=this.entries[n].value);return t}},{key:"getDateLabel",value:function(e){return e}},{key:"getDaysUntil",value:function(e,t){var n=t.getTime()-e.getTime();return Math.ceil(n/864e5)}}]),e}(),b=function e(t,n){Object(o.a)(this,e),this.value=t,this.date=n},m=function(){function e(t){Object(o.a)(this,e),this.name=t,this.dateEntries=[]}return Object(u.a)(e,[{key:"initStorage",value:function(e){this.storage=e}},{key:"getDistancesOnDate",value:function(e){var t=this.getDateEntry(e);return null!==t?t.getDistances():[]}},{key:"addEntry",value:function(e){var t=this.getDateEntry(e);null===t&&(t=this.storage.create(e,this.name),this.dateEntries.push(t)),t.addExerciseEntry(0,"")}},{key:"removeEntry",value:function(e,t){var n=this.getDateEntry(e);null!==n&&n.removeEntry(t)}},{key:"setDistance",value:function(e,t,n){var a=this.getDateEntry(e);if(null!==a)return a.setDistance(t,n)}},{key:"update",value:function(e){var t=this.getDateEntry(e);null!==t&&t.update()}},{key:"getDateEntry",value:function(e){for(var t=0;t<this.dateEntries.length;t++)if(this.dateEntries[t].date===e)return this.dateEntries[t];return null}}]),e}(),y=n(73);n(219);y.a.initializeApp({databaseURL:"https://joriswebsitefirebase-default-rtdb.europe-west1.firebasedatabase.app/"});var p=y.a.database(),O=function(){function e(t,n,a){var r=this;Object(o.a)(this,e),this.date=t,this.name=n,this.dataCache=[],this.callback=a,p.ref("users/"+this.name+"/"+this.date).on("value",(function(e){r.triggerValueUpdate(e)}))}return Object(u.a)(e,[{key:"triggerValueUpdate",value:function(e){var t=e.val();console.log("Getting data: "+t),e.exists()?this.dataCache=t:this.dataCache=[],this.callback()}},{key:"addExerciseEntry",value:function(e,t){var n=p.ref("users/"+this.name+"/"+this.date);n.get().then((function(t){var a=[];t.exists()&&(a=t.val()),a.push(e),n.set(a)})).catch((function(e){console.error(e)}))}},{key:"setDistance",value:function(e,t){var n=p.ref("users/"+this.name+"/"+this.date);n.get().then((function(a){if(a.exists()){var r=a.val();e<r.length&&(r[e]=t),n.set(r)}})).catch((function(e){console.error(e)}))}},{key:"removeEntry",value:function(e){console.log("Removing...");var t=p.ref("users/"+this.name+"/"+this.date);t.get().then((function(n){if(n.exists()){var a=n.val();e<a.length&&a.splice(e,1),t.set(a)}})).catch((function(e){console.error(e)}))}},{key:"update",value:function(){console.log("updating");var e=p.ref("users/"+this.name+"/"+this.date);e.get().then((function(t){if(t.exists()){var n=t.val();e.set(n)}})).catch((function(e){console.error(e)}))}},{key:"getDistances",value:function(){return this.dataCache}}]),e}(),x=function(){function e(t){Object(o.a)(this,e),this.callback=t}return Object(u.a)(e,[{key:"create",value:function(e,t){return new O(e,t,this.callback)}}]),e}(),D=function(){function e(t){Object(o.a)(this,e),this.users=[new m("Joris"),new m("Minyu"),new m("New User")]}return Object(u.a)(e,[{key:"init",value:function(e){for(var t=new x(e),n=0;n<this.users.length;n++)this.users[n].initStorage(t)}},{key:"getUser",value:function(e){for(var t=0;t<this.users.length;t++)if(this.users[t].name===e)return this.users[t];return null}},{key:"getUserNames",value:function(){for(var e=[],t=0;t<this.users.length;t++)e.push(this.users[t].name);return e}}]),e}(),E=n(267),k=n(268),w=n(265),N=n(255),C=n(261),S=Object(N.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},default:{margin:e.spacing(3,0,1,0)},section1:{margin:e.spacing(3,2)},section3:{margin:e.spacing(3,1,1)}}}));function U(e){var t=S();return Object(v.jsxs)("div",{className:t.root,children:[Object(v.jsxs)("div",{className:t.section1,children:[Object(v.jsx)("div",{className:t.default,children:Object(v.jsx)(E.a,{children:"Select the active user"})}),Object(v.jsx)(w.a,{style:{width:160},onChange:function(t){e.processUserSelect(t.target.value)},children:e.items.map((function(e,t){return Object(v.jsx)(k.a,{value:e,children:e})}))})]}),Object(v.jsx)(C.a,{variant:"middle"})]})}var I=n(222),A=n(266),L=n(263),W=n(262);var H=function(e){return Object(v.jsxs)("div",{className:"DataInputStyle",children:[Object(v.jsx)(I.a,{color:"textSecondary",variant:"body2",children:"Add entries for the selected date"}),Object(v.jsxs)(W.a,{container:!0,alignItems:"center",children:[Object(v.jsx)(W.a,{item:!0,xs:!0,children:Object(v.jsx)(A.a,{type:"date",defaultValue:e.activeDate,onChange:function(t){e.processDateChange(t.target.value)}})}),Object(v.jsx)(W.a,{item:!0,children:Object(v.jsx)(L.a,{color:"primary",style:{maxWidth:"100px",maxHeight:"30px",minWidth:"100px",minHeight:"30px"},variant:"contained",onClick:e.addEntry,children:"Add"})})]})]})},R=n(264);var T=function(e){var t=Object(a.useState)(e.distance),n=Object(c.a)(t,2),r=n[0],i=n[1];return Object(v.jsx)("div",{className:"DataEntryStyle",children:Object(v.jsxs)(W.a,{container:!0,alignItems:"center",children:[Object(v.jsx)(W.a,{item:!0,xs:!0,children:Object(v.jsx)(A.a,{label:"Distance",InputProps:{endAdornment:Object(v.jsx)(R.a,{position:"start",children:"km"})},value:r,onChange:function(t){i(t.target.value),e.confirmInput(e.index,t.target.value)}})}),Object(v.jsx)(W.a,{item:!0,children:Object(v.jsx)(L.a,{style:{maxWidth:"30px",maxHeight:"30px",minWidth:"30px",minHeight:"30px"},color:"secondary",variant:"contained",onClick:function(t){e.removeEntry(e.index)},children:"X"})})]})})},G=Object(N.a)((function(e){return{root:{width:"100%",maxWidth:500,backgroundColor:e.palette.background.paper},default:{margin:e.spacing(3,0,1,0),backgroundColor:e.palette.common.white},sectionColumnRight:{width:"50%",float:"right",margin:e.spacing(3,2),backgroundColor:"lightGray"},section1:{margin:e.spacing(2,2)},section3:{margin:e.spacing(3,1,1)}}}));function J(e){var t=G();function n(t){e.removeEntry(e.user,t)}function a(t,n){var a=Number(n);isNaN(a)||e.modifyEntry(e.user,t,a)}return Object(v.jsxs)("div",{className:t.root,children:[Object(v.jsx)("div",{className:t.section1,children:Object(v.jsxs)(I.a,{color:"textSecondary",variant:"body2",children:["Entry overview for ",e.user.name,":"]})}),Object(v.jsx)("div",{className:"AreaInputNew",children:Object(v.jsxs)("div",{className:"UserEntriesContainer",children:[Object(v.jsx)(H,{addEntry:function(){e.addEntry(e.user)},activeDate:e.activeDate,processDateChange:function(t){e.modifyDate(e.user,t)}}),0===e.userEntries.length&&Object(v.jsx)("div",{className:"DataEntryStyle",children:Object(v.jsxs)(I.a,{color:"primary",variant:"body2",children:["No entries yet for ",e.user.name," on ",e.activeDate]})}),e.userEntries.map((function(t,r){return Object(v.jsx)(T,{name:e.user.name,confirmInput:a,removeEntry:n,distance:t,index:r})}))]})})]})}var M=new D;var V=function(){var e=Object(a.useState)([0]),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([""]),s=Object(c.a)(i,2),o=s[0],u=s[1],l=Object(a.useState)(""),d=Object(c.a)(l,2),h=d[0],f=d[1],b=Object(a.useState)([]),m=Object(c.a)(b,2),y=m[0],p=m[1],O=Object(a.useState)((new Date).toISOString().substring(0,10)),x=Object(c.a)(O,2),D=x[0],E=x[1];return M.init((function(){console.log("Updating the data");var e=M.getUser(h);null!==e&&p(e.getDistancesOnDate(D));for(var t=new j,n=0;n<M.users.length;n++)for(var a=M.users[n],i=0;i<a.dateEntries.length;i++)for(var s=a.dateEntries[i],c=s.date,o=s.getDistances(),l=0;l<o.length;l++)t.addDataEntry(o[l],c);for(var d=t.getDates(),v=[],f=0;f<d.length;f++)v[f]=t.getAdditionOnDate(d[f]);for(var g=0;g<d.length;g++)d[g]=t.getDateLabel(d[g]);r(v),u(d)})),Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"UserContainer",children:[Object(v.jsx)("div",{className:"PersonEntry",children:Object(v.jsx)(U,{items:M.getUserNames(),processUserSelect:function(e){f(e);var t=M.getUser(e);null!==t&&t.update(D)}})}),h.length>0&&Object(v.jsx)("div",{children:Object(v.jsx)(J,{user:M.getUser(h),userEntries:y,activeDate:D,removeEntry:function(e,t){e.removeEntry(D,t)},addEntry:function(e){e.addEntry(D)},modifyEntry:function(e,t,n){e.setDistance(D,t,n)},modifyDate:function(e,t){E(t),e.update(t)}})})]}),Object(v.jsx)("div",{className:"GraphContainer",children:Object(v.jsx)(g,{data:n,dates:o})})]})};s.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(V,{})}),document.getElementById("root"))}},[[221,1,2]]]);
//# sourceMappingURL=main.cd97c543.chunk.js.map